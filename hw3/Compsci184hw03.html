<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_abnfp7r1yckg-8>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-8}.lst-kix_uw879117xg35-4>li{counter-increment:lst-ctn-kix_uw879117xg35-4}ol.lst-kix_nrbdu47q6f8t-7.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-7 0}ol.lst-kix_abnfp7r1yckg-2.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-2 0}.lst-kix_nrbdu47q6f8t-8>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-8}ol.lst-kix_uw879117xg35-2.start{counter-reset:lst-ctn-kix_uw879117xg35-2 0}ol.lst-kix_abnfp7r1yckg-5.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-5 0}.lst-kix_abnfp7r1yckg-7>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-7}.lst-kix_nrbdu47q6f8t-7>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-7}.lst-kix_abnfp7r1yckg-6>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-6}ol.lst-kix_uw879117xg35-7.start{counter-reset:lst-ctn-kix_uw879117xg35-7 0}.lst-kix_uw879117xg35-5>li{counter-increment:lst-ctn-kix_uw879117xg35-5}ol.lst-kix_nrbdu47q6f8t-1{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-0{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-3{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-2{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-5{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-4{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-7{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-6{list-style-type:none}ol.lst-kix_nrbdu47q6f8t-8{list-style-type:none}.lst-kix_uw879117xg35-2>li{counter-increment:lst-ctn-kix_uw879117xg35-2}ol.lst-kix_nrbdu47q6f8t-2.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-2 0}ol.lst-kix_uw879117xg35-4.start{counter-reset:lst-ctn-kix_uw879117xg35-4 0}.lst-kix_uw879117xg35-7>li{counter-increment:lst-ctn-kix_uw879117xg35-7}.lst-kix_abnfp7r1yckg-1>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-1,lower-latin) ". "}.lst-kix_abnfp7r1yckg-3>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-3,decimal) ". "}.lst-kix_nrbdu47q6f8t-5>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-5}.lst-kix_abnfp7r1yckg-0>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-0,decimal) ". "}.lst-kix_abnfp7r1yckg-4>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-4,lower-latin) ". "}.lst-kix_uw879117xg35-1>li{counter-increment:lst-ctn-kix_uw879117xg35-1}ol.lst-kix_abnfp7r1yckg-1{list-style-type:none}ol.lst-kix_abnfp7r1yckg-0{list-style-type:none}.lst-kix_abnfp7r1yckg-2>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-2,lower-roman) ". "}.lst-kix_nrbdu47q6f8t-4>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-4}.lst-kix_abnfp7r1yckg-0>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-0}ol.lst-kix_uw879117xg35-0.start{counter-reset:lst-ctn-kix_uw879117xg35-0 0}ol.lst-kix_uw879117xg35-5.start{counter-reset:lst-ctn-kix_uw879117xg35-5 0}ol.lst-kix_nrbdu47q6f8t-1.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-1 0}ol.lst-kix_abnfp7r1yckg-3{list-style-type:none}ol.lst-kix_abnfp7r1yckg-2{list-style-type:none}ol.lst-kix_abnfp7r1yckg-5{list-style-type:none}ol.lst-kix_abnfp7r1yckg-4{list-style-type:none}ol.lst-kix_abnfp7r1yckg-7{list-style-type:none}ol.lst-kix_abnfp7r1yckg-6{list-style-type:none}ol.lst-kix_abnfp7r1yckg-4.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-4 0}ol.lst-kix_abnfp7r1yckg-8{list-style-type:none}.lst-kix_nrbdu47q6f8t-7>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-7,lower-latin) ". "}.lst-kix_uw879117xg35-2>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-2,lower-roman) ". "}.lst-kix_abnfp7r1yckg-2>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-2}.lst-kix_nrbdu47q6f8t-4>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-4,lower-latin) ". "}.lst-kix_nrbdu47q6f8t-8>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-8,lower-roman) ". "}.lst-kix_uw879117xg35-3>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-3,decimal) ". "}.lst-kix_nrbdu47q6f8t-3>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-3,decimal) ". "}.lst-kix_uw879117xg35-6>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-6,decimal) ". "}.lst-kix_nrbdu47q6f8t-1>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-1,lower-latin) ". "}.lst-kix_uw879117xg35-4>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-4,lower-latin) ". "}ol.lst-kix_uw879117xg35-6.start{counter-reset:lst-ctn-kix_uw879117xg35-6 0}.lst-kix_nrbdu47q6f8t-2>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-2,lower-roman) ". "}.lst-kix_uw879117xg35-5>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-5,lower-roman) ". "}.lst-kix_nrbdu47q6f8t-1>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-1}.lst-kix_abnfp7r1yckg-3>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-3}.lst-kix_nrbdu47q6f8t-0>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-0,decimal) ". "}ol.lst-kix_nrbdu47q6f8t-0.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-0 0}.lst-kix_uw879117xg35-7>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-7,lower-latin) ". "}ol.lst-kix_nrbdu47q6f8t-3.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-3 0}ol.lst-kix_uw879117xg35-3.start{counter-reset:lst-ctn-kix_uw879117xg35-3 0}.lst-kix_uw879117xg35-8>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-8,lower-roman) ". "}ol.lst-kix_nrbdu47q6f8t-8.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-8 0}.lst-kix_abnfp7r1yckg-1>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-1}.lst-kix_abnfp7r1yckg-4>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-4}ol.lst-kix_nrbdu47q6f8t-6.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-6 0}ol.lst-kix_uw879117xg35-1.start{counter-reset:lst-ctn-kix_uw879117xg35-1 0}ol.lst-kix_abnfp7r1yckg-3.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-3 0}ol.lst-kix_abnfp7r1yckg-6.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-6 0}.lst-kix_uw879117xg35-8>li{counter-increment:lst-ctn-kix_uw879117xg35-8}.lst-kix_abnfp7r1yckg-8>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-8,lower-roman) ". "}.lst-kix_abnfp7r1yckg-5>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-5,lower-roman) ". "}.lst-kix_abnfp7r1yckg-7>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-7,lower-latin) ". "}.lst-kix_nrbdu47q6f8t-2>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-2}.lst-kix_nrbdu47q6f8t-5>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-5,lower-roman) ". "}.lst-kix_uw879117xg35-0>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-0,decimal) ". "}.lst-kix_nrbdu47q6f8t-6>li:before{content:"" counter(lst-ctn-kix_nrbdu47q6f8t-6,decimal) ". "}.lst-kix_uw879117xg35-1>li:before{content:"" counter(lst-ctn-kix_uw879117xg35-1,lower-latin) ". "}.lst-kix_abnfp7r1yckg-6>li:before{content:"" counter(lst-ctn-kix_abnfp7r1yckg-6,decimal) ". "}.lst-kix_abnfp7r1yckg-5>li{counter-increment:lst-ctn-kix_abnfp7r1yckg-5}ol.lst-kix_abnfp7r1yckg-7.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-7 0}ol.lst-kix_nrbdu47q6f8t-5.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-5 0}ol.lst-kix_abnfp7r1yckg-0.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-0 0}ol.lst-kix_uw879117xg35-8.start{counter-reset:lst-ctn-kix_uw879117xg35-8 0}ol.lst-kix_uw879117xg35-6{list-style-type:none}ol.lst-kix_uw879117xg35-5{list-style-type:none}ol.lst-kix_uw879117xg35-4{list-style-type:none}ol.lst-kix_abnfp7r1yckg-8.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-8 0}ol.lst-kix_uw879117xg35-3{list-style-type:none}ol.lst-kix_uw879117xg35-2{list-style-type:none}ol.lst-kix_uw879117xg35-1{list-style-type:none}ol.lst-kix_uw879117xg35-0{list-style-type:none}.lst-kix_uw879117xg35-0>li{counter-increment:lst-ctn-kix_uw879117xg35-0}.lst-kix_uw879117xg35-6>li{counter-increment:lst-ctn-kix_uw879117xg35-6}.lst-kix_nrbdu47q6f8t-0>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-0}.lst-kix_uw879117xg35-3>li{counter-increment:lst-ctn-kix_uw879117xg35-3}.lst-kix_nrbdu47q6f8t-6>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-6}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_nrbdu47q6f8t-3>li{counter-increment:lst-ctn-kix_nrbdu47q6f8t-3}ol.lst-kix_nrbdu47q6f8t-4.start{counter-reset:lst-ctn-kix_nrbdu47q6f8t-4 0}ol.lst-kix_abnfp7r1yckg-1.start{counter-reset:lst-ctn-kix_abnfp7r1yckg-1 0}ol.lst-kix_uw879117xg35-8{list-style-type:none}ol.lst-kix_uw879117xg35-7{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c2{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt;height:11pt}.c1{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:center;padding-right:0pt}.c4{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;border-left-width:0pt;border-top-style:solid;background-color:#ffffff;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c0{color:#333333;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c11{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Times New Roman";font-style:normal}.c13{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c6{font-size:12pt;font-family:"Times New Roman";color:#333333;font-weight:400}.c14{color:#333333;text-decoration:none;vertical-align:baseline;font-style:normal}.c8{text-decoration:none;vertical-align:baseline;font-style:italic}.c9{font-size:12pt;font-family:"Times New Roman";font-weight:400}.c3{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c12{font-size:12pt;font-family:"Times New Roman";font-weight:700}.c10{padding:0;margin:0}.c19{margin-left:40.5pt}.c15{height:11pt}.c16{margin-left:72pt}.c7{margin-left:36pt}.c17{font-style:italic}.c18{text-indent:36pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><p class="c13"><span class="c11">Compsci 184 Hw03</span></p><p class="c13"><span class="c5">Maodun Zhang 3035626112</span></p><p class="c13"><span class="c9">Haoqing Xuan 3036149505</span><hr style="page-break-before:always;display:none;"></p><p class="c13"><span class="c11">Part 1</span></p><p class="c13"><span class="c11">Ray generation</span></p><p class="c4"><span class="c5">Ray generation is the first step in the ray tracing process. In this step, for each pixel of the image, a ray is generated that originates from the camera&#39;s viewpoint (eye position) and passes through a point on the virtual image plane. This plane is positioned in the scene at a distance that is usually equal to the focal length of the camera. The direction of each ray depends on the camera&#39;s field of view, aspect ratio, and the relative position of the pixel within the image frame.</span></p><p class="c2"><span class="c5"></span></p><p class="c4"><span class="c5">To generate a ray, we first convert the pixel coordinates to normalized device coordinates (NDC), which range from -1 to 1, with (0,0) being the center of the image. Then, we adjust these coordinates based on the aspect ratio and the field of view to find the corresponding point on the image plane in camera space. This point is transformed into world space using the camera&#39;s transformation matrix. Finally, a ray is defined by its origin (the camera&#39;s position) and its direction (from the camera&#39;s position to the transformed point on the image plane).</span></p><p class="c2"><span class="c5"></span></p><p class="c4"><span class="c5">Steps of ray generation:</span></p><p class="c4"><span class="c5">Step 1: Convert the normalized image coordinates to screen space coordinates</span></p><p class="c4"><span class="c5">Step 2: Adjust these screen space coordinates according to the camera&#39;s field of view </span></p><p class="c4"><span class="c5">Step 3: Set the z-coordinate in camera space to -1 and normalize the direction vector</span></p><p class="c4"><span class="c5">Step 4: Transform the direction vector from camera space to world space using the c2w matrix</span></p><p class="c4"><span class="c5">Step 5: Create a Ray object with the camera&#39;s position as the origin and the transformed direction as the direction</span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c5"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 361.50px;"><img alt="" src="images/image15.png" style="width: 480.00px; height: 361.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c5">banana.png (part 1.1 &amp; 1.2)</span></p><p class="c1 c15"><span class="c5"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image32.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c5">CBempty.png (part 1.1 &amp; 1.2)</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image41.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c5">CBspheres.png (full part 1)</span></p><p class="c1 c15"><span class="c5"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image37.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c5">CBempty.png (full part 1)</span></p><p class="c2"><span class="c11"></span></p><p class="c2"><span class="c11"></span></p><p class="c2"><span class="c11"></span></p><p class="c4"><span class="c12">T</span><span class="c11">riangle intersection algorithm</span></p><p class="c4"><span class="c9">When we are g</span><span class="c5">iven a ray, we calculate vectors e1 and e2 between the triangle&#39;s vertices p1, p2, and p3, and we then compute the vectors s, s1, and s2 to aid in the intersection calculation.</span></p><p class="c4"><span class="c5">Using cross products and dot products, we determine coefficients t, b1, b2, and b3 to check if the intersection point lies within the triangle and along the ray&#39;s direction. If the intersection point is within the triangle and within the ray&#39;s bounds (t within r.min_t and r.max_t), we will update the intersection. And we use Barycentric coordinates to interpolate the normal at the intersection point. We also update the intersection structure with the intersection details and return true if an intersection is found, otherwise false.</span></p><p class="c2"><span class="c5"></span></p><p class="c4"><span class="c11">Sphere intersection algorithm:</span></p><p class="c4"><span class="c5">When we are given a ray, we calculate the vector oc from the sphere&#39;s center o to the ray&#39;s origin.</span></p><p class="c4"><span class="c5">We compute the coefficients for the quadratic equation representing the intersection between the ray and the sphere, and if the discriminant (b^2 - 4ac) is negative, there are no real roots, indicating that the ray does not intersect the sphere. We then calculate the two roots of the quadratic equation using the quadratic formula and store the smaller root in t1 and the larger root in t2, and return true to indicate that the ray intersects the sphere. If there are intersections, we choose the smaller valid intersection point within the ray&#39;s bounds (r.min_t and r.max_t) and update the intersection structure with the intersection details. And finally, we update the ray&#39;s max_t to the closest intersection point and return true to indicate a valid intersection.</span></p><p class="c2"><span class="c5"></span></p><p class="c2"><span class="c5"></span></p><p class="c2"><span class="c5"></span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c5"></span></p><p class="c4"><span class="c11">Part 2</span></p><p class="c4"><span class="c11">BVH construction algorithm</span></p><p class="c4"><span class="c5">1. Compute Bounding Box: </span></p><p class="c4 c7"><span class="c5">The algorithm starts by computing a bounding box (BBox) that encloses all the primitives (e.g., triangles, spheres) in the current node. This is done by iterating over all primitives in the range [start, end) and expanding the bounding box to include each primitive&#39;s bounding box.</span></p><p class="c4"><span class="c5">2. Node Creation:</span></p><p class="c4 c18"><span class="c5">A new BVH node is created with the computed bounding box.</span></p><p class="c4"><span class="c5">3. Leaf or Interior Node Determination:</span></p><p class="c4 c7"><span class="c5">The algorithm checks if the number of primitives in the current node is less than or equal to a specified max_leaf_size. If true, this node becomes a leaf node, and it directly stores the range of primitives. If false, the node is an interior node and needs to be split.</span></p><p class="c4"><span class="c5">4. Splitting Criteria:</span></p><p class="c4 c7"><span class="c5">Finding Longest Axis: The algorithm calculates the extents of the bounding box along each axis (x, y, z). It then identifies the longest axis. This is crucial for determining where to split the node.</span></p><p class="c4 c7"><span class="c5">Midpoint Splitting: The split position is chosen based on the midpoint of the longest axis. The idea is to divide the primitives into two groups, each occupying a sub-volume of the current node&#39;s volume.</span></p><p class="c4"><span class="c5">5. Partitioning Primitives:</span></p><p class="c4 c7"><span class="c5">The primitives are partitioned around this split position. A standard std::partition algorithm is used, which rearranges the primitives so that all primitives whose centroids are less than the split position along the chosen axis come before all other primitives.</span></p><p class="c4"><span class="c5">6. Handling Edge Cases:</span></p><p class="c4 c7"><span class="c5">If all primitives end up on one side of the split (which can happen if they are very unevenly distributed), the algorithm falls back to a simple median split. This avoids creating highly unbalanced trees.</span></p><p class="c4"><span class="c5">7. Recursive Construction:</span></p><p class="c4 c7"><span class="c5">The function then recursively calls itself for the two sets of primitives (those before and after the partitioning point), creating left and right child nodes.</span></p><p class="c4"><span class="c5">8. Return Node:</span></p><p class="c4 c7"><span class="c9">Finally, the constructed node (which now has a bounding box, and potentially left and right children) is returned.</span><hr style="page-break-before:always;display:none;"></p><p class="c4"><span class="c11">Heuristic for Splitting</span></p><p class="c4"><span class="c5">The heuristic used here for picking the splitting point is the midpoint of the longest axis of the bounding box. This is a common and effective heuristic in BVH construction. The choice of the longest axis helps to ensure that the split will, on average, create more balanced child volumes, especially for elongated shapes. The midpoint is a simple yet often effective choice for the split position as it tends to divide the primitives fairly evenly, at least spatially.</span></p><p class="c2"><span class="c5"></span></p><p class="c4"><span class="c5">This heuristic is a balance between computational efficiency and tree quality. More complex methods (like Surface Area Heuristic, SAH) can create more optimized trees but at the cost of higher construction times. The midpoint heuristic provides a good compromise, especially in cases where the overhead of more complex methods is not justified.</span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c5"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.37px;"><img alt="" src="images/image40.png" style="width: 480.00px; height: 360.37px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c6 c8">dae/sky/CBlucy.dae</span></p><p class="c1 c15"><span class="c6 c8"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.38px;"><img alt="" src="images/image36.png" style="width: 480.00px; height: 360.38px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c6 c8">dae/meshedit/maxplanck.dae</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 480.00px;"><img alt="" src="images/image33.png" style="width: 480.00px; height: 480.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c6 c8">dae/sky/dragon.dae</span></p><p class="c1 c15"><span class="c5"></span></p><hr style="page-break-before:always;display:none;"><p class="c1 c15"><span class="c5"></span></p><p class="c4"><span class="c12">Rendering Time Difference Analysis</span></p><p class="c4"><span class="c5">The rendering times for the three scenes with moderately complex geometries illustrate the significant efficiency gains provided by Bounding Volume Hierarchy (BVH) acceleration. For the &quot;dragon.dae&quot; scene, using BVH acceleration reduced the rendering time from 122.3147 seconds to just 0.0336 seconds, a dramatic decrease that highlights the efficiency of BVH in handling complex geometry. Similarly, for the &quot;CBlucy.dae&quot; scene, the rendering time dropped from 85.7079 seconds without BVH to 0.0407 seconds with BVH, demonstrating the acceleration&#39;s effectiveness in optimizing rendering processes. The &quot;maxplanck.dae&quot; scene also shows considerable improvement, reducing rendering time from 38.0238 seconds to 0.0391 seconds when employing BVH acceleration. These results indicate that BVH acceleration can drastically reduce rendering times, especially in scenes with complex geometries. This acceleration is likely due to the efficient spatial subdivision and reduced number of intersection tests that BVH offers, as it allows the rendering algorithm to quickly disregard large volumes of irrelevant geometry for each ray. The consistency of the results across different scenes reaffirms that BVH acceleration is a robust optimization technique for speeding up the rendering of complex 3D scenes.</span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c5"></span></p><p class="c4"><span class="c14 c12">Part 3</span></p><p class="c4"><span class="c0">Walkthrough:</span></p><p class="c4"><span class="c0">1. Uniform Hemisphere Sampling: This method estimates the direct lighting at an intersection point by sampling directions uniformly in a hemisphere. It iterates over a fixed number of samples, sampling a direction in the hemisphere, generating a ray in that direction from the hit point, and checking for intersections with scene geometry. If an intersection occurs, it evaluates the BSDF and accumulates the contribution from that direction. Finally, it normalizes the accumulated result by the number of samples and the probability of each sample.</span></p><p class="c4"><span class="c0">2. Light Sampling: This method estimates direct lighting by sampling from lights in the scene. It iterates over each light and, if the light is a delta light , we samples the light, creates a shadow ray towards the light sample, checks for intersections with scene geometry, and adds the contribution from the light if no intersection occurs. It then normalizes the accumulated result by dividing by the total number of lights in the scene.</span></p><p class="c4"><span class="c0">3. The uniform hemisphere sampling method provides a straightforward approach to estimating direct lighting, sampling directions uniformly in a hemisphere around the hit point. However, it may miss some important light sources in the scene, especially if the light sources are not uniformly distributed in all directions. Light sampling focuses specifically on light sources in the scene, ensuring that all lights contribute to the estimation, which can lead to more accurate results, showing a smoother image. Light sampling requires more careful handling of delta lights and shadow rays to estimate the direct lighting contribution from each light source accurately.</span></p><p class="c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 359.81px; height: 359.81px;"><img alt="" src="images/image3.png" style="width: 359.81px; height: 359.81px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c6 c17">dae/sky/dragon.dae</span><hr style="page-break-before:always;display:none;"></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image7.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Image of using uniform hemisphere</span></p><p class="c1 c15"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image38.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c6">Image of using direct light sampling</span><hr style="page-break-before:always;display:none;"></p><p class="c4"><span class="c14 c12">Here are the pictures rendered with different parameters</span></p><p class="c2"><span class="c14 c12"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image4.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">1 sample pixel, 1 light ray</span></p><p class="c1 c15"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image1.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">1 sample pixel, 4 light rays</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image14.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">1 sample pixel, 16 light rays</span></p><p class="c1 c15"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image21.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">1 sample pixel, 64 light rays</span></p><hr style="page-break-before:always;display:none;"><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">Part 4:</span></p><ol class="c10 lst-kix_nrbdu47q6f8t-0 start" start="1"><li class="c4 c7 li-bullet-0"><span class="c0">we start by computing the direct lighting contribution using the one_bounce_radiance function, which estimates the lighting from the intersection point directly from light sources or by sampling the hemisphere. Next, we check if the recursion depth has reached the maximum specified by max_ray_depth. If it has, we terminate the recursion and return the accumulated radiance. Then, we sample the BSDF of the material at the intersection point and perform Russian roulette with a chosen termination probability. If the termination condition is met, we terminate the recursion and return the accumulated radiance. If Russian roulette fails, indicating that we continue the recursion, we create a new ray in the sampled direction and recursively trace it. We accumulate the radiance from the bounced ray and return the total accumulated radiance.</span></li><li class="c4 c7 li-bullet-0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image30.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image19.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c4 c7 li-bullet-0"><span class="c6">Direct Illumination only:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image18.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c4 c19"><span class="c6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indirect Illumination:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image11.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><ol class="c10 lst-kix_nrbdu47q6f8t-0" start="4"><li class="c4 c7 li-bullet-0"><span class="c0">Below are pictures of isAccumBounces=false and m = 0, 1, 2, 3, 4, 5 in order:</span></li></ol><ol class="c10 lst-kix_nrbdu47q6f8t-1 start" start="1"><li class="c4 c16 li-bullet-0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 375.33px; height: 281.50px;"><img alt="" src="images/image9.png" style="width: 375.33px; height: 281.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 375.04px; height: 281.28px;"><img alt="" src="images/image34.png" style="width: 375.04px; height: 281.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 373.50px; height: 280.42px;"><img alt="" src="images/image28.png" style="width: 373.50px; height: 280.42px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 375.04px; height: 281.28px;"><img alt="" src="images/image2.png" style="width: 375.04px; height: 281.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 376.37px; height: 282.28px;"><img alt="" src="images/image35.png" style="width: 376.37px; height: 282.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 376.37px; height: 282.28px;"><img alt="" src="images/image31.png" style="width: 376.37px; height: 282.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c4 c16 li-bullet-0"><span class="c6">Below are the case for isAccumBounces=true, and m = 0, 1, 2, 3, 4, 5 in order:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 376.50px; height: 282.09px;"><img alt="" src="images/image9.png" style="width: 376.50px; height: 282.09px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 377.50px; height: 283.13px;"><img alt="" src="images/image17.png" style="width: 377.50px; height: 283.13px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 381.71px; height: 286.28px;"><img alt="" src="images/image16.png" style="width: 381.71px; height: 286.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 380.37px; height: 285.28px;"><img alt="" src="images/image12.png" style="width: 380.37px; height: 285.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 376.50px; height: 281.84px;"><img alt="" src="images/image6.png" style="width: 376.50px; height: 281.84px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 377.71px; height: 283.28px;"><img alt="" src="images/image26.png" style="width: 377.71px; height: 283.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c4 c16 li-bullet-0"><span class="c0">At the 2nd bounce, rays are traced from surfaces that have already been hit by the first ray. This bounce represents indirect illumination, where light has bounced off surfaces, which might lead to softer shadows and increased global illumination effects. The contribution of the 2nd bounce improves the overall realism and lighting quality of the scene.And the 3rd bounce extends the indirect illumination further by tracing rays that bounce off surfaces already illuminated by the 2nd bounce, which adds another layer of complexity to the lighting simulation and results in more subtle effects like multiple reflections and refractions. As a result, the scene becomes even more realistic. Comparing the rendered images to rasterization, we can notice that ray tracing with multiple bounces of light produces more accurate lighting and shadowing effects, especially in scenes with complex geometry and materials. Ray tracing captures the behavior of light better with more details, which may be challenging to achieve with rasterization techniques alone.</span></li><li class="c4 c16 li-bullet-0"><span class="c6">Below are the pictures of using Russian Roulette with m = 0, 1, 2, 3, 4, 100</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 354.50px; height: 265.88px;"><img alt="" src="images/image9.png" style="width: 354.50px; height: 265.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 355.74px; height: 266.80px;"><img alt="" src="images/image12.png" style="width: 355.74px; height: 266.80px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 355.50px; height: 266.11px;"><img alt="" src="images/image16.png" style="width: 355.50px; height: 266.11px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 356.37px; height: 267.28px;"><img alt="" src="images/image6.png" style="width: 356.37px; height: 267.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 357.71px; height: 268.28px;"><img alt="" src="images/image6.png" style="width: 357.71px; height: 268.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 356.37px; height: 267.28px;"><img alt="" src="images/image29.png" style="width: 356.37px; height: 267.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c4 c16 li-bullet-0"><span class="c6">Below are pictures of spheres with 1, 2, 4, 8, 16, 64, 1024 sample-per-pixel rates </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 349.95px; height: 261.34px;"><img alt="" src="images/image5.png" style="width: 349.95px; height: 261.34px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 351.50px; height: 263.63px;"><img alt="" src="images/image22.png" style="width: 351.50px; height: 263.63px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 356.37px; height: 267.28px;"><img alt="" src="images/image25.png" style="width: 356.37px; height: 267.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 352.37px; height: 264.28px;"><img alt="" src="images/image20.png" style="width: 352.37px; height: 264.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 354.50px; height: 265.88px;"><img alt="" src="images/image24.png" style="width: 354.50px; height: 265.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 355.04px; height: 266.28px;"><img alt="" src="images/image8.png" style="width: 355.04px; height: 266.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 356.37px; height: 267.28px;"><img alt="" src="images/image13.png" style="width: 356.37px; height: 267.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c2"><span class="c0"></span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c12 c14">Part 5</span></p><p class="c4"><span class="c0">In my implementation of adaptive sampling within a ray tracing algorithm, I begin by setting a base number of samples per pixel. My goal is to dynamically adjust this number based on the complexity of each pixel&#39;s content. Here&rsquo;s how I approach it:</span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">Initial Setup:</span></p><p class="c4"><span class="c0">I start with a predefined number of samples for each pixel. I also initialize variables to keep track of the accumulated color (avgColor) and the statistics needed for the adaptive sampling decision (s1 and s2 for sum of illuminance and its square, respectively).</span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">Sampling and Ray Tracing:</span></p><p class="c4"><span class="c0">In a loop, I generate camera rays for each sample. For this, I calculate normalized coordinates within the pixel, ensuring each sample covers a different part of the pixel. I trace each ray through the scene and estimate the radiance along it. I accumulate these radiance estimates to form the average color for the pixel, and simultaneously, I update s1 and s2 for the adaptive sampling calculations.</span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">Adaptive Decision:</span></p><p class="c4"><span class="c0">Every few samples (as defined by samplesPerBatch), I pause to assess the variance in the samples I&#39;ve taken so far. Using s1 and s2, I calculate the mean and standard deviation of the sample illuminances. With these, I determine the confidence interval of the mean. If this interval is smaller than a set tolerance level (defined by maxTolerance) relative to the mean, I interpret it as the pixel&#39;s color being sufficiently resolved. In that case, I stop sampling early for that pixel.</span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">Finalizing Pixel Color:</span></p><p class="c4"><span class="c0">Once I exit the sampling loop&mdash;either because I&#39;ve reached the maximum number of samples or decided to stop early based on the adaptive criteria&mdash;I finalize the average color for the pixel. This involves dividing the accumulated color by the actual number of samples taken. I then update the pixel&#39;s color in the image.</span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">In essence, my adaptive sampling strategy allows me to focus computational resources more effectively. Pixels in complex areas (with high detail or noise) receive more samples, while simpler areas get fewer samples. This approach helps me achieve a good balance between image quality and rendering efficiency. The adaptiveness is finely controlled by samplesPerBatch and maxTolerance, which I tune based on the specific needs of the scene I&#39;m rendering.</span></p><p class="c2"><span class="c0"></span></p><p class="c4"><span class="c0">Rendered Images and rate images:</span></p><ol class="c10 lst-kix_uw879117xg35-0 start" start="1"><li class="c4 c7 li-bullet-0"><span class="c6">Bunny:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 398.00px; height: 298.50px;"><img alt="" src="images/image23.png" style="width: 398.00px; height: 298.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 381.71px; height: 286.28px;"><img alt="" src="images/image39.png" style="width: 381.71px; height: 286.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li><li class="c4 c7 li-bullet-0"><span class="c6">Spheres:</span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 400.67px; height: 300.50px;"><img alt="" src="images/image27.png" style="width: 400.67px; height: 300.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 377.71px; height: 283.28px;"><img alt="" src="images/image10.png" style="width: 377.71px; height: 283.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c2"><span class="c0"></span></p></body></html>